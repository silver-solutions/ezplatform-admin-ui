{% extends "@ezdesign/ui/layout.html.twig" %}

{% trans_default_domain 'ezcommerce_erp_admin_control_center' %}

{% block breadcrumbs %}
    {% include '@ezdesign/ui/breadcrumbs.html.twig' with { items: [
        { value: 'e-commerce' },
        { value: 'Control Center' }
    ]} %}
{% endblock %}

{% block page_title %}
    {% include '@ezdesign/ui/page_title.html.twig' with {
        title: 'Control Center',
        iconName: 'core'
    } %}
{% endblock %}

{% block body_class %}ez-ecommerce-control-center{% endblock %}

{% block content %}
    <div class="row ez-header pt-3">
        <div class="container">
            <ul class="nav nav-tabs ez-tabs px-4" role="tablist">
            {% if erp_connection %}
                <li class="nav-item">
                    <a
                        class="nav-link"
                        data-toggle="tab"
                        href="#ez-tab-erp-overview"
                        role="tab"
                        aria-controls="ez-tab-erp-overview"
                        aria-expanded=""
                        aria-selected="false">
                        {{ 'erp.overview'|trans|desc('ERP overview') }}
                    </a>
                </li>
                <li class="nav-item">
                    <a
                        class="nav-link"
                        data-toggle="tab"
                        href="#ez-tab-erp-logs"
                        role="tab"
                        aria-controls="ez-tab-erp-logs"
                        aria-expanded=""
                        aria-selected="false">
                        {{ 'erp.request_log'|trans|desc('ERP request log') }}
                    </a>
                </li>
                <li class="nav-item">
                    <a
                        class="nav-link"
                        data-toggle="tab"
                        href="#ez-tab-erp-performance"
                        role="tab"
                        aria-controls="ez-tab-erp-performance"
                        aria-expanded=""
                        aria-selected="false">
                        {{ 'erp.performance'|trans|desc('ERP performance') }}
                    </a>
                </li>
            {% endif %}
                <li class="nav-item">
                    <a
                        class="nav-link active"
                        data-toggle="tab"
                        href="#ez-tab-email-archive"
                        role="tab"
                        aria-controls="ez-tab-email-archive"
                        aria-expanded=""
                        aria-selected="false">
                        {{ 'email_archive'|trans|desc('email archive') }}
                    </a>
                </li>
            {% if ses_config_parameter('catalog_data_provider','silver_eshop') == 'econtent' %}
                <li class="nav-item">
                    <a
                        class="nav-link"
                        data-toggle="tab"
                        href="#ez-tab-jobs-econtent"
                        role="tab"
                        aria-controls="ez-tab-jobs-econtent"
                        aria-expanded=""
                        aria-selected="false">
                        {{ 'econtent_tasks'|trans|desc('eContent tasks') }}
                    </a>
                </li>
                <li class="nav-item">
                    <a
                        class="nav-link"
                        data-toggle="tab"
                        href="#ez-tab-econtent-types"
                        role="tab"
                        aria-controls="ez-tab-econtent-types"
                        aria-expanded=""
                        aria-selected="false">
                        {{ 'econtent_types'|trans|desc('eContent types') }}
                    </a>
                </li>
            {% endif %}
                <li class="nav-item">
                    <a
                        class="nav-link"
                        data-toggle="tab"
                        href="#ez-tab-ecommerce-jobs"
                        role="tab"
                        aria-controls="ez-tab-jobs-econtent"
                        aria-expanded=""
                        aria-selected="false">
                        {{ 'ecommerce_jobs'|trans|desc('e-commerce jobs') }}
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <div class="tab-content container mt-4 px-5">
    {% if erp_connection %}
        <div class="tab-pane" id="ez-tab-erp-overview" role="tabpanel">
            {{ render(controller('Ibexa\\Commerce\\Bundle\\AdminUiBundle\\Controller\\ControlCenterController::showOverviewAction')) }}
        </div>
        <div class="tab-pane" id="ez-tab-erp-logs" role="tabpanel">
            {{ render(controller('Ibexa\\Commerce\\Bundle\\AdminUiBundle\\Controller\\ControlCenterController::showEventsAction', {'request': app.request.request})) }}
        </div>
        <div class="tab-pane" id="ez-tab-erp-performance" role="tabpanel">
            {{ render(controller('Ibexa\\Commerce\\Bundle\\AdminUiBundle\\Controller\\ControlCenterController::showGraphAction', {'request': app.request.request})) }}
        </div>
    {% endif %}
        <div class="tab-pane active" id="ez-tab-email-archive" role="tabpanel">
            {% include '@ezdesign/part/email_archive.html.twig' %}
        </div>
    {% if ses_config_parameter('catalog_data_provider','silver_eshop') == 'econtent' %}
        <div class="tab-pane" id="ez-tab-jobs-econtent" role="tabpanel">
            {% include '@ezdesign/part/econtent_tasks.html.twig' %}
        </div>
        <div class="tab-pane" id="ez-tab-econtent-types" role="tabpanel">
            <div class="ez-econtent-types" data-template="{{ include('@ezdesign/part/econtent_types.html.twig', {
                name: '{{ name }}'
            })|e('html_attr') }}"></div>
        </div>
    {% endif %}
        <div class="tab-pane" id="ez-tab-ecommerce-jobs" role="tabpanel">
            {% include '@ezdesign/part/jobs_list.html.twig'  %}
        </div>
    </div>
{% endblock %}

{% block stylesheets %}
    {{ encore_entry_link_tags('ezcommerce-admin-ui-control-center-css', null, 'ezplatform') }}
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('bundles/sisoadminerpplugin/js/d3.min.js') }}"></script>
    <script src="{{ asset('bundles/sisoadminerpplugin/js/c3.min.js') }}"></script>

    {{ encore_entry_script_tags('ezcommerce-admin-ui-control-center-js', null, 'ezplatform') }}
{% endblock %}
